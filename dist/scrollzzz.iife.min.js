/**
 * @license MIT
 * @author Luca Poldelmengo
 * @see {@link https://github.com/pldg/scrollzzz}
 */
var scrollzzz=function(){"use strict";function e(e){return"number"==typeof e&&!isNaN(parseFloat(e))}function t(e){return"string"==typeof e&&e.length>0}return function(r){var n=r.trigger;void 0===n&&(n=1);var o=r.progress;void 0===o&&(o=!1);var i=r.debug;void 0===i&&(i=!1);var s=r.root;void 0===s&&(s=null);var c,u,l,a,d,f,v=r.targets,g=r.unobserve,p=r.throttle,w=(c=0,u="down",function(){var e=s?s.scrollTop:window.pageYOffset,t=u;return e>c||e===c&&"down"===u?t="down":(e<c||e===c&&"up"===u)&&(t="up"),c=e,u=t,t}),b={},h=[],y=!1,m=!!o&&function(){var e=!1;try{var t={get passive(){e={passive:!0}}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch(t){e=!1}return e}(),z=[],E=o&&"intersect"!==g,x=!0;function L(e){var t=document.createElement("div"),r=document.createElement("p");if(t.style.height="0px",t.style.borderTop="2px dashed grey",t.style.zIndex="9999",e){var o=e.getBoundingClientRect(),i=o.height,s=o.width;t.style.position="absolute",t.style.top=n*i+function(e){var t=window.pageYOffset,r=window.pageXOffset,n=document.body.clientTop||0,o=document.body.clientLeft||0,i=e.getBoundingClientRect(),s=i.top,c=i.left,u=i.height,l=i.width;return{top:s=s+t-n,left:c=c+r-o,height:u,width:l,bottom:s+u,right:c+l}}(e).top+"px",t.style.width=s+"px"}else t.style.position="fixed",t.style.width="100%",t.style.top=100*n+"vh";r.style.fontFamily="monospace",r.style.color="grey",r.style.margin="0",r.style.padding="6px",r.innerText='targets: "'+v+'", trigger: '+n,t.setAttribute("class",O()),t.appendChild(r),document.body.appendChild(t)}function O(){return"scrollzzz-trigger--"+("."===v[0]||"#"===v[0]?v.substring(1):v)}function S(e,t){E&&(f=e[0].rootBounds.top),d&&e.forEach((function(e){var r=function(e){var t=e.isIntersecting,r=e.rootBounds.top,n=e.boundingClientRect.top>r;return t?"intersect":!t&&n?"below":"above"}(e),n=e.target,o=parseInt(n.dataset.scrollzzz);d({direction:w(),progress:E?C(e):null,position:r,entry:e}),x&&E&&function(e){var t=function(e){return p?(t=o,r=p,n=Date.now(),function(){n+r-Date.now()<0&&(t(),n=Date.now())}):o;var t,r,n;function o(t){d({direction:w(),progress:C(e),position:"intersect",entry:e})}}(e);z.push({addScroll:function(){return window.addEventListener("scroll",t,m)},removeScroll:function(){return window.removeEventListener("scroll",t,m)}})}(e),E&&function(e,t){var r=e.isIntersecting,n=z[t],o=n.addScroll,i=n.removeScroll;r?o():r||x||i()}(e,o),g&&(!function(e,t,r){var n="below"===g&&"below"===e,o="intersect"===g&&"intersect"===e,i="above"===g&&"above"===e;("onLoad"===g||n||o||i)&&r.unobserve(t)}(r,n,t),h.push(o))})),x&&(x=!1)}function C(e){var t=e.target.getBoundingClientRect(),r=t.top,n=1/(t.height/(f-r));return n<0?0:n>1?1:parseFloat(n.toFixed(4))}function B(){throw new Error("scrollzzz has not been initialized")}return b.init=function(){if(y)throw new Error("scrollzzz has beed already initialized");var r;return function(){if(t(v)||r("targets"),!e(n)||n>1||n<0)throw new Error("trigger must be a number in 0..1 range");if(g){if(!(["onLoad","below","intersect","above"].indexOf(g)>-1))throw new Error('unobserve must be "onLoad" or "below" or "intersect" or "above"');if(o&&"intersect"===g)throw new Error('if using progress, unobserve can not be "intersect"')}if(!e(p)&&p>0)throw new Error("throttle must be a number > 0");function r(e){throw new Error(e+" must be a valid DOM selector")}s&&!t(s)&&r("root")}(),t(s)&&(l=document.querySelector(s)),!0===i&&L(l),a=new IntersectionObserver(S,{rootMargin:(r=100*n,"-"+r+"% 0% -"+(100-r)+"% 0%"),root:l||null}),[].slice.call(document.querySelectorAll(v)).forEach((function(e,t){e.hasAttribute("data-scrollzzz")||e.setAttribute("data-scrollzzz",t),-1===h.indexOf(t)&&a.observe(e)})),y=!0,b},b.observe=function(e){if(y||B(),"function"!=typeof e)throw new Error("observe requires a function");return d=e,b},b.disconnect=function(e){var t;return void 0===e&&(e=!1),y||B(),o&&z.forEach((function(e){return(0,e.removeScroll)()})),!0===i&&(t=document.querySelector("."+O())).parentNode.removeChild(t),e&&h.splice(0),a.disconnect(),y=!1,b},b.update=function(e,t){return void 0===e&&(e={}),void 0===t&&(t=!1),b.disconnect(t),v=e.targets||v,n=e.trigger||n,g=e.unobserve||g,o=e.progress||o,p=e.throttle||p,s=e.root||s,i=e.debug||i,b.init(),b},Object.freeze(b)}}();
